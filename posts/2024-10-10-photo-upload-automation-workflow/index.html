<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Automating upload workflow using Selenium | ca4mi</title>
<meta name=keywords content><meta name=description content="Automating upload workflow using Selenium"><meta name=author content="ca4mi"><link rel=canonical href=https://ca4mi.github.io/posts/2024-10-10-photo-upload-automation-workflow/><link crossorigin=anonymous href=/assets/css/stylesheet.45e028aa8ce0961349adf411b013ee39406be2c0bc80d4ea3fc04555f7f4611a.css integrity="sha256-ReAoqozglhNJrfQRsBPuOUBr4sC8gNTqP8BFVff0YRo=" rel="preload stylesheet" as=style><link rel=icon href=https://ca4mi.github.io/static/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://ca4mi.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://ca4mi.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://ca4mi.github.io/apple-touch-icon.png><link rel=mask-icon href=https://ca4mi.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://ca4mi.github.io/posts/2024-10-10-photo-upload-automation-workflow/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:url" content="https://ca4mi.github.io/posts/2024-10-10-photo-upload-automation-workflow/"><meta property="og:site_name" content="ca4mi"><meta property="og:title" content="Automating upload workflow using Selenium"><meta property="og:description" content="Automating upload workflow using Selenium"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-10-10T00:00:00+00:00"><meta property="article:modified_time" content="2024-10-10T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Automating upload workflow using Selenium"><meta name=twitter:description content="Automating upload workflow using Selenium"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://ca4mi.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Automating upload workflow using Selenium","item":"https://ca4mi.github.io/posts/2024-10-10-photo-upload-automation-workflow/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Automating upload workflow using Selenium","name":"Automating upload workflow using Selenium","description":"Automating upload workflow using Selenium","keywords":[],"articleBody":"Often need to efficiently share large photo sets with clients. This post outlines a workflow that utilizes automation tools for managing and organizing the process, specifically focusing on WeTransfer file sharing.\nWeTransfer’s free tier offers up to 2GB of shared files for 7 days before they expire. For larger projects, it’s necessary to split photos into manageable chunks (around 1.8GB each) before uploading.\nStep 1: Initial Photo Selection and Ranking\nAfter shooting a session, photographers should carefully select the best images. Software like Darktable or Lightroom can be used to identify poorly exposed or blurry photos and discard them. The remaining photos are then ranked, and low-resolution copies are exported to a designated folder. This bash script can further filter photo filenames and save them as a text file for easy reference.\nls | grep -oP '\\d+' \u003e filenames.txt Step 2: Handling Client Requests for All Photos\nOccasionally, clients may request all high-quality images, regardless of initial ranking or non-selected photos that not edited or non-post-production versions. In these cases, can simply gather the full set of JPEGs and organize them according to the filenames listed in the filenames.txt. This is bash script:\n#!/bin/bash # Define variables numbers_file=\"/path/to/Photos/filenames.txt\" # Path to your text file containing the numbers source_dir=\"/path/to/Photos/raw/jpg\" # Directory where the files are located destination_dir=\"/path/to/Photos/new_photo_folder\" # Directory to copy the matching files # Read each number from the text file while IFS= read -r number; do # Find and copy files starting with the number find \"$source_dir\" -type f -name \"*$number*\" -exec cp {} \"$destination_dir\" \\; done \u003c \"$numbers_file\" echo \"Photos copied successfully!\" Step 3: Splitting Photos into WeTransfer-Friendly Chunks\nA custom bash script (wt_split.sh) split the photos into chunks of approximately 1.8GB each. This ensures that stay within WeTransfer’s file size limits.\n#!/bin/bash # Usage: ./split_dir.sh /path/to/large_directory # Check if directory is provided if [ -z \"$1\" ]; then echo \"Usage: $0 /path/to/directory\" exit 1 fi # Variables DIR_PATH=$1 PART_SIZE=$((1800 * 1024 * 1024)) # 1.8GB in bytes OUTPUT_DIR=\"upload_to_wt\" COUNTER=1 CURRENT_SIZE=0 # Create output directory mkdir -p $OUTPUT_DIR # Create first part directory PART_DIR=\"$OUTPUT_DIR/part_$COUNTER\" mkdir -p \"$PART_DIR\" # Loop through files in the directory find \"$DIR_PATH\" -type f | while read FILE; do FILE_SIZE=$(stat --printf=\"%s\" \"$FILE\") # Check if adding this file exceeds the part size limit if (( CURRENT_SIZE + FILE_SIZE \u003e PART_SIZE )); then # Create new part directory and reset size ((COUNTER++)) PART_DIR=\"$OUTPUT_DIR/part_$COUNTER\" mkdir -p \"$PART_DIR\" CURRENT_SIZE=0 fi # Move file to current part directory mv \"$FILE\" \"$PART_DIR/\" CURRENT_SIZE=$((CURRENT_SIZE + FILE_SIZE)) done echo \"Directory $DIR_PATH has been split into directories of up to 1.8GB in $OUTPUT_DIR/.\" Step 4: Uploading with Python and Selenium\nFinally, a Python code (wetransfer_selenium.py) leverages the Selenium library to automate the WeTransfer upload process. This script handles selecting photos, uploading files, and generating a shareable link for clients.\nimport sys import os from selenium import webdriver from selenium.webdriver.common.by import By from selenium.webdriver.support.ui import WebDriverWait from selenium.webdriver.support import expected_conditions as EC import time # Check if the user provided a file or directory to upload if len(sys.argv) != 2: print(\"Usage: python3 wetransfer_selenium.py \") sys.exit(1) # Get the file or directory path from the command-line argument file_or_dir_path = sys.argv[1] # Check if the path exists if not os.path.exists(file_or_dir_path): print(f\"Error: The path {file_or_dir_path} does not exist.\") sys.exit(1) # Set up the browser (use Chrome or Firefox) driver = webdriver.Chrome() # Or webdriver.Firefox() wait = WebDriverWait(driver, 20) # Add an explicit wait # Open WeTransfer website driver.get(\"https://wetransfer.com/\") # Wait for the page to load fully time.sleep(5) # Optional: increase the sleep time if necessary # Wait for the \"Accept All Cookies\" button to appear and click it try: accept_cookies_button = wait.until(EC.element_to_be_clickable((By.XPATH, \"//button[contains(text(), 'Accept All')]\"))) accept_cookies_button.click() print(\"Accepted cookies.\") except Exception as e: print(\"Error locating or clicking the Accept All button:\", e) driver.quit() sys.exit(1) # Wait for the \"I Agree\" button to appear and click it try: agree_button = wait.until(EC.element_to_be_clickable((By.XPATH, \"//button[contains(text(), 'I agree')]\"))) agree_button.click() print(\"Agreed to the terms.\") except Exception as e: print(\"Error locating or clicking the I Agree button:\", e) driver.quit() sys.exit(1) # Click the three-dot button to open more options try: print(\"Clicking the three-dot button for more options...\") three_dot_button = wait.until(EC.element_to_be_clickable((By.XPATH, \"//span[@data-testid='iconbar-icon']\"))) three_dot_button.click() except Exception as e: print(\"Error clicking the three-dot button:\", e) driver.quit() sys.exit(1) # Select the \"Create link\" boolean option try: print(\"Selecting 'Create link' boolean option...\") create_link_radio = wait.until(EC.element_to_be_clickable((By.XPATH, \"//input[@id='transfer__type-link']\"))) if not create_link_radio.is_selected(): driver.execute_script(\"arguments[0].click();\", create_link_radio) print(\"'Create link' option selected.\") else: print(\"'Create link' option is already selected.\") except Exception as e: print(\"Error selecting 'Create link' option:\", e) driver.quit() sys.exit(1) # Proceed to set the expiry options try: print(\"Opening expiry dropdown...\") expiry_dropdown = wait.until(EC.element_to_be_clickable((By.XPATH, \"//button[contains(@class, 'TransferWindowSetExpiry_input')]\"))) driver.execute_script(\"arguments[0].click();\", expiry_dropdown) print(\"Expiry dropdown opened.\") # Wait for the dropdown options to be visible seven_days_option = wait.until(EC.element_to_be_clickable((By.XPATH, \"//li[contains(text(), '7 days')]\"))) # Click the '7 days' option driver.execute_script(\"arguments[0].click();\", seven_days_option) print(\"Expiry set to 7 days.\") except Exception as e: print(\"Error selecting '7 days' option:\", e) driver.quit() sys.exit(1) # Wait for the uploader form to appear try: print(\"Waiting for the uploader form...\") wait.until(EC.visibility_of_element_located((By.CLASS_NAME, \"uploader--form\"))) print(\"Uploader form is now visible.\") except Exception as e: print(\"Error locating the uploader form:\", e) driver.quit() sys.exit(1) # Wait for the file input element to appear try: print(\"Waiting for the file input element...\") file_input = wait.until(EC.presence_of_element_located((By.CSS_SELECTOR, 'input[data-testid=\"file-input\"]'))) print(\"File input element located successfully.\") except Exception as e: print(\"Error locating the file input element:\", e) driver.quit() sys.exit(1) # Upload file(s) time.sleep(3) # If it's a directory, get all files inside the directory if os.path.isdir(file_or_dir_path): files = [os.path.join(file_or_dir_path, file) for file in os.listdir(file_or_dir_path)] else: files = [file_or_dir_path] # Upload each file for file_path in files: print(f\"Fetch: {file_path}\") file_input.send_keys(file_path) # Upload the file(s) # Click the 'Get a link' button try: print(\"Clicking the 'Get a link' button...\") get_link_button = WebDriverWait(driver, 30).until(EC.element_to_be_clickable((By.XPATH, \"//button[contains(text(), 'Get a link')]\"))) get_link_button.click() print(\"'Get a link' button clicked.\") except Exception as e: print(f\"Error clicking the 'Get a link' button: {e}\") driver.quit() sys.exit(1) # Waiting for Transferring.. text will shown in page time.sleep(3) try: print(\"'Transferring...'\") WebDriverWait(driver, 7200).until(EC.invisibility_of_element_located((By.XPATH, \"//div[contains(@class, 'transfer__window uploader--progress')]//h2[text()='Transferring...']\"))) print(\"Upload complete.\") except Exception as e: print(f\"Error waiting for the upload to complete: {e}\") driver.quit() sys.exit(1) time.sleep(10) # Get the download link try: link = WebDriverWait(driver, 60).until(EC.presence_of_element_located((By.CSS_SELECTOR, \".TransferDetails__link.link input.link__url\"))) link = WebDriverWait(driver, 30).until(EC.visibility_of_element_located((By.CSS_SELECTOR, \".TransferDetails__link.link input.link__url\"))) # Retrieve the link download_link = link.get_attribute(\"value\") print(f\"Download link: {download_link}\") except Exception as e: print(\"Error retrieving the download link:\", e) driver.quit() sys.exit(1) # Close the browser driver.quit() ","wordCount":"1042","inLanguage":"en","datePublished":"2024-10-10T00:00:00Z","dateModified":"2024-10-10T00:00:00Z","author":{"@type":"Person","name":"ca4mi"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://ca4mi.github.io/posts/2024-10-10-photo-upload-automation-workflow/"},"publisher":{"@type":"Organization","name":"ca4mi","logo":{"@type":"ImageObject","url":"https://ca4mi.github.io/static/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://ca4mi.github.io/ accesskey=h title="ca4mi (Alt + H)">ca4mi</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://ca4mi.github.io/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://ca4mi.github.io/photos/ title=Photos><span>Photos</span></a></li><li><a href=https://ca4mi.github.io/bookmark/ title=Bookmark><span>Bookmark</span></a></li><li><a href=https://ca4mi.github.io/using/ title=Using><span>Using</span></a></li><li><a href=https://ca4mi.github.io/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://ca4mi.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Automating upload workflow using Selenium</h1><div class=post-description>Automating upload workflow using Selenium</div><div class=post-meta><span title='2024-10-10 00:00:00 +0000 UTC'>October 10, 2024</span>&nbsp;·&nbsp;ca4mi</div></header><div class=post-content><p>Often need to efficiently share large photo sets with clients. This post outlines a workflow that utilizes automation tools for managing and organizing the process, specifically focusing on WeTransfer file sharing.</p><p>WeTransfer&rsquo;s free tier offers up to 2GB of shared files for 7 days before they expire. For larger projects, it&rsquo;s necessary to split photos into manageable chunks (around 1.8GB each) before uploading.</p><p><strong>Step 1: Initial Photo Selection and Ranking</strong></p><p>After shooting a session, photographers should carefully select the best images. Software like Darktable or Lightroom can be used to identify poorly exposed or blurry photos and discard them. The remaining photos are then ranked, and low-resolution copies are exported to a designated folder. This bash script can further filter photo filenames and save them as a text file for easy reference.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ls <span class=p>|</span> grep -oP <span class=s1>&#39;\d+&#39;</span> &gt; filenames.txt
</span></span></code></pre></div><p><strong>Step 2: Handling Client Requests for All Photos</strong></p><p>Occasionally, clients may request all high-quality images, regardless of initial ranking or non-selected photos that not edited or non-post-production versions. In these cases, can simply gather the full set of JPEGs and organize them according to the filenames listed in the <code>filenames.txt</code>. This is bash script:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=cp>#!/bin/bash
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=c1># Define variables</span>
</span></span><span class=line><span class=cl><span class=nv>numbers_file</span><span class=o>=</span><span class=s2>&#34;/path/to/Photos/filenames.txt&#34;</span> <span class=c1># Path to your text file containing the numbers</span>
</span></span><span class=line><span class=cl><span class=nv>source_dir</span><span class=o>=</span><span class=s2>&#34;/path/to/Photos/raw/jpg&#34;</span> <span class=c1># Directory where the files are located</span>
</span></span><span class=line><span class=cl><span class=nv>destination_dir</span><span class=o>=</span><span class=s2>&#34;/path/to/Photos/new_photo_folder&#34;</span> <span class=c1># Directory to copy the matching files</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Read each number from the text file</span>
</span></span><span class=line><span class=cl><span class=k>while</span> <span class=nv>IFS</span><span class=o>=</span> <span class=nb>read</span> -r number<span class=p>;</span> <span class=k>do</span>
</span></span><span class=line><span class=cl>    <span class=c1># Find and copy files starting with the number</span>
</span></span><span class=line><span class=cl>    find <span class=s2>&#34;</span><span class=nv>$source_dir</span><span class=s2>&#34;</span> -type f -name <span class=s2>&#34;*</span><span class=nv>$number</span><span class=s2>*&#34;</span> -exec cp <span class=o>{}</span> <span class=s2>&#34;</span><span class=nv>$destination_dir</span><span class=s2>&#34;</span> <span class=se>\;</span>
</span></span><span class=line><span class=cl><span class=k>done</span> &lt; <span class=s2>&#34;</span><span class=nv>$numbers_file</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;Photos copied successfully!&#34;</span>
</span></span></code></pre></div><p><strong>Step 3: Splitting Photos into WeTransfer-Friendly Chunks</strong></p><p>A custom bash script (<code>wt_split.sh</code>) split the photos into chunks of approximately 1.8GB each. This ensures that stay within WeTransfer&rsquo;s file size limits.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=cp>#!/bin/bash
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=c1># Usage: ./split_dir.sh /path/to/large_directory</span>
</span></span><span class=line><span class=cl><span class=c1># Check if directory is provided</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> -z <span class=s2>&#34;</span><span class=nv>$1</span><span class=s2>&#34;</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>  <span class=nb>echo</span> <span class=s2>&#34;Usage: </span><span class=nv>$0</span><span class=s2> /path/to/directory&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nb>exit</span> <span class=m>1</span>
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Variables</span>
</span></span><span class=line><span class=cl><span class=nv>DIR_PATH</span><span class=o>=</span><span class=nv>$1</span>
</span></span><span class=line><span class=cl><span class=nv>PART_SIZE</span><span class=o>=</span><span class=k>$((</span><span class=m>1800</span> <span class=o>*</span> <span class=m>1024</span> <span class=o>*</span> <span class=m>1024</span><span class=k>))</span>  <span class=c1># 1.8GB in bytes</span>
</span></span><span class=line><span class=cl><span class=nv>OUTPUT_DIR</span><span class=o>=</span><span class=s2>&#34;upload_to_wt&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>COUNTER</span><span class=o>=</span><span class=m>1</span>
</span></span><span class=line><span class=cl><span class=nv>CURRENT_SIZE</span><span class=o>=</span><span class=m>0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Create output directory</span>
</span></span><span class=line><span class=cl>mkdir -p <span class=nv>$OUTPUT_DIR</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Create first part directory</span>
</span></span><span class=line><span class=cl><span class=nv>PART_DIR</span><span class=o>=</span><span class=s2>&#34;</span><span class=nv>$OUTPUT_DIR</span><span class=s2>/part_</span><span class=nv>$COUNTER</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>mkdir -p <span class=s2>&#34;</span><span class=nv>$PART_DIR</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Loop through files in the directory</span>
</span></span><span class=line><span class=cl>find <span class=s2>&#34;</span><span class=nv>$DIR_PATH</span><span class=s2>&#34;</span> -type f <span class=p>|</span> <span class=k>while</span> <span class=nb>read</span> FILE<span class=p>;</span> <span class=k>do</span>
</span></span><span class=line><span class=cl>  <span class=nv>FILE_SIZE</span><span class=o>=</span><span class=k>$(</span>stat --printf<span class=o>=</span><span class=s2>&#34;%s&#34;</span> <span class=s2>&#34;</span><span class=nv>$FILE</span><span class=s2>&#34;</span><span class=k>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1># Check if adding this file exceeds the part size limit</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=o>((</span> CURRENT_SIZE + FILE_SIZE &gt; PART_SIZE <span class=o>))</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>    <span class=c1># Create new part directory and reset size</span>
</span></span><span class=line><span class=cl>    <span class=o>((</span>COUNTER++<span class=o>))</span>
</span></span><span class=line><span class=cl>    <span class=nv>PART_DIR</span><span class=o>=</span><span class=s2>&#34;</span><span class=nv>$OUTPUT_DIR</span><span class=s2>/part_</span><span class=nv>$COUNTER</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>    mkdir -p <span class=s2>&#34;</span><span class=nv>$PART_DIR</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nv>CURRENT_SIZE</span><span class=o>=</span><span class=m>0</span>
</span></span><span class=line><span class=cl>  <span class=k>fi</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1># Move file to current part directory</span>
</span></span><span class=line><span class=cl>  mv <span class=s2>&#34;</span><span class=nv>$FILE</span><span class=s2>&#34;</span> <span class=s2>&#34;</span><span class=nv>$PART_DIR</span><span class=s2>/&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nv>CURRENT_SIZE</span><span class=o>=</span><span class=k>$((</span>CURRENT_SIZE <span class=o>+</span> FILE_SIZE<span class=k>))</span>
</span></span><span class=line><span class=cl><span class=k>done</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;Directory </span><span class=nv>$DIR_PATH</span><span class=s2> has been split into directories of up to 1.8GB in </span><span class=nv>$OUTPUT_DIR</span><span class=s2>/.&#34;</span>
</span></span></code></pre></div><p><strong>Step 4: Uploading with Python and Selenium</strong></p><p>Finally, a Python code (<code>wetransfer_selenium.py</code>) leverages the Selenium library to automate the WeTransfer upload process. This script handles selecting photos, uploading files, and generating a shareable link for clients.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>sys</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>selenium</span> <span class=kn>import</span> <span class=n>webdriver</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>selenium.webdriver.common.by</span> <span class=kn>import</span> <span class=n>By</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>selenium.webdriver.support.ui</span> <span class=kn>import</span> <span class=n>WebDriverWait</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>selenium.webdriver.support</span> <span class=kn>import</span> <span class=n>expected_conditions</span> <span class=k>as</span> <span class=n>EC</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>time</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Check if the user provided a file or directory to upload</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>sys</span><span class=o>.</span><span class=n>argv</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>2</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Usage: python3 wetransfer_selenium.py &lt;path_to_file_or_directory&gt;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>sys</span><span class=o>.</span><span class=n>exit</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Get the file or directory path from the command-line argument</span>
</span></span><span class=line><span class=cl><span class=n>file_or_dir_path</span> <span class=o>=</span> <span class=n>sys</span><span class=o>.</span><span class=n>argv</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Check if the path exists</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=ow>not</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>exists</span><span class=p>(</span><span class=n>file_or_dir_path</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Error: The path </span><span class=si>{</span><span class=n>file_or_dir_path</span><span class=si>}</span><span class=s2> does not exist.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>sys</span><span class=o>.</span><span class=n>exit</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Set up the browser (use Chrome or Firefox)</span>
</span></span><span class=line><span class=cl><span class=n>driver</span> <span class=o>=</span> <span class=n>webdriver</span><span class=o>.</span><span class=n>Chrome</span><span class=p>()</span>  <span class=c1># Or webdriver.Firefox()</span>
</span></span><span class=line><span class=cl><span class=n>wait</span> <span class=o>=</span> <span class=n>WebDriverWait</span><span class=p>(</span><span class=n>driver</span><span class=p>,</span> <span class=mi>20</span><span class=p>)</span>  <span class=c1># Add an explicit wait</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Open WeTransfer website</span>
</span></span><span class=line><span class=cl><span class=n>driver</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&#34;https://wetransfer.com/&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Wait for the page to load fully</span>
</span></span><span class=line><span class=cl><span class=n>time</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mi>5</span><span class=p>)</span>  <span class=c1># Optional: increase the sleep time if necessary</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Wait for the &#34;Accept All Cookies&#34; button to appear and click it</span>
</span></span><span class=line><span class=cl><span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>accept_cookies_button</span> <span class=o>=</span> <span class=n>wait</span><span class=o>.</span><span class=n>until</span><span class=p>(</span><span class=n>EC</span><span class=o>.</span><span class=n>element_to_be_clickable</span><span class=p>((</span><span class=n>By</span><span class=o>.</span><span class=n>XPATH</span><span class=p>,</span> <span class=s2>&#34;//button[contains(text(), &#39;Accept All&#39;)]&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>    <span class=n>accept_cookies_button</span><span class=o>.</span><span class=n>click</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Accepted cookies.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Error locating or clicking the Accept All button:&#34;</span><span class=p>,</span> <span class=n>e</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>driver</span><span class=o>.</span><span class=n>quit</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>sys</span><span class=o>.</span><span class=n>exit</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Wait for the &#34;I Agree&#34; button to appear and click it</span>
</span></span><span class=line><span class=cl><span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>agree_button</span> <span class=o>=</span> <span class=n>wait</span><span class=o>.</span><span class=n>until</span><span class=p>(</span><span class=n>EC</span><span class=o>.</span><span class=n>element_to_be_clickable</span><span class=p>((</span><span class=n>By</span><span class=o>.</span><span class=n>XPATH</span><span class=p>,</span> <span class=s2>&#34;//button[contains(text(), &#39;I agree&#39;)]&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>    <span class=n>agree_button</span><span class=o>.</span><span class=n>click</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Agreed to the terms.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Error locating or clicking the I Agree button:&#34;</span><span class=p>,</span> <span class=n>e</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>driver</span><span class=o>.</span><span class=n>quit</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>sys</span><span class=o>.</span><span class=n>exit</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Click the three-dot button to open more options</span>
</span></span><span class=line><span class=cl><span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Clicking the three-dot button for more options...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>three_dot_button</span> <span class=o>=</span> <span class=n>wait</span><span class=o>.</span><span class=n>until</span><span class=p>(</span><span class=n>EC</span><span class=o>.</span><span class=n>element_to_be_clickable</span><span class=p>((</span><span class=n>By</span><span class=o>.</span><span class=n>XPATH</span><span class=p>,</span> <span class=s2>&#34;//span[@data-testid=&#39;iconbar-icon&#39;]&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>    <span class=n>three_dot_button</span><span class=o>.</span><span class=n>click</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Error clicking the three-dot button:&#34;</span><span class=p>,</span> <span class=n>e</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>driver</span><span class=o>.</span><span class=n>quit</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>sys</span><span class=o>.</span><span class=n>exit</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Select the &#34;Create link&#34; boolean option</span>
</span></span><span class=line><span class=cl><span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Selecting &#39;Create link&#39; boolean option...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>create_link_radio</span> <span class=o>=</span> <span class=n>wait</span><span class=o>.</span><span class=n>until</span><span class=p>(</span><span class=n>EC</span><span class=o>.</span><span class=n>element_to_be_clickable</span><span class=p>((</span><span class=n>By</span><span class=o>.</span><span class=n>XPATH</span><span class=p>,</span> <span class=s2>&#34;//input[@id=&#39;transfer__type-link&#39;]&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=n>create_link_radio</span><span class=o>.</span><span class=n>is_selected</span><span class=p>():</span>
</span></span><span class=line><span class=cl>        <span class=n>driver</span><span class=o>.</span><span class=n>execute_script</span><span class=p>(</span><span class=s2>&#34;arguments[0].click();&#34;</span><span class=p>,</span> <span class=n>create_link_radio</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;&#39;Create link&#39; option selected.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;&#39;Create link&#39; option is already selected.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Error selecting &#39;Create link&#39; option:&#34;</span><span class=p>,</span> <span class=n>e</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>driver</span><span class=o>.</span><span class=n>quit</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>sys</span><span class=o>.</span><span class=n>exit</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Proceed to set the expiry options</span>
</span></span><span class=line><span class=cl><span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Opening expiry dropdown...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>expiry_dropdown</span> <span class=o>=</span> <span class=n>wait</span><span class=o>.</span><span class=n>until</span><span class=p>(</span><span class=n>EC</span><span class=o>.</span><span class=n>element_to_be_clickable</span><span class=p>((</span><span class=n>By</span><span class=o>.</span><span class=n>XPATH</span><span class=p>,</span> <span class=s2>&#34;//button[contains(@class, &#39;TransferWindowSetExpiry_input&#39;)]&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>    <span class=n>driver</span><span class=o>.</span><span class=n>execute_script</span><span class=p>(</span><span class=s2>&#34;arguments[0].click();&#34;</span><span class=p>,</span> <span class=n>expiry_dropdown</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Expiry dropdown opened.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Wait for the dropdown options to be visible</span>
</span></span><span class=line><span class=cl>    <span class=n>seven_days_option</span> <span class=o>=</span> <span class=n>wait</span><span class=o>.</span><span class=n>until</span><span class=p>(</span><span class=n>EC</span><span class=o>.</span><span class=n>element_to_be_clickable</span><span class=p>((</span><span class=n>By</span><span class=o>.</span><span class=n>XPATH</span><span class=p>,</span> <span class=s2>&#34;//li[contains(text(), &#39;7 days&#39;)]&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Click the &#39;7 days&#39; option</span>
</span></span><span class=line><span class=cl>    <span class=n>driver</span><span class=o>.</span><span class=n>execute_script</span><span class=p>(</span><span class=s2>&#34;arguments[0].click();&#34;</span><span class=p>,</span> <span class=n>seven_days_option</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Expiry set to 7 days.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Error selecting &#39;7 days&#39; option:&#34;</span><span class=p>,</span> <span class=n>e</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>driver</span><span class=o>.</span><span class=n>quit</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>sys</span><span class=o>.</span><span class=n>exit</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Wait for the uploader form to appear</span>
</span></span><span class=line><span class=cl><span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Waiting for the uploader form...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>wait</span><span class=o>.</span><span class=n>until</span><span class=p>(</span><span class=n>EC</span><span class=o>.</span><span class=n>visibility_of_element_located</span><span class=p>((</span><span class=n>By</span><span class=o>.</span><span class=n>CLASS_NAME</span><span class=p>,</span> <span class=s2>&#34;uploader--form&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Uploader form is now visible.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Error locating the uploader form:&#34;</span><span class=p>,</span> <span class=n>e</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>driver</span><span class=o>.</span><span class=n>quit</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>sys</span><span class=o>.</span><span class=n>exit</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Wait for the file input element to appear</span>
</span></span><span class=line><span class=cl><span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Waiting for the file input element...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>file_input</span> <span class=o>=</span> <span class=n>wait</span><span class=o>.</span><span class=n>until</span><span class=p>(</span><span class=n>EC</span><span class=o>.</span><span class=n>presence_of_element_located</span><span class=p>((</span><span class=n>By</span><span class=o>.</span><span class=n>CSS_SELECTOR</span><span class=p>,</span> <span class=s1>&#39;input[data-testid=&#34;file-input&#34;]&#39;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;File input element located successfully.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Error locating the file input element:&#34;</span><span class=p>,</span> <span class=n>e</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>driver</span><span class=o>.</span><span class=n>quit</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>sys</span><span class=o>.</span><span class=n>exit</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Upload file(s)</span>
</span></span><span class=line><span class=cl><span class=n>time</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># If it&#39;s a directory, get all files inside the directory</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>isdir</span><span class=p>(</span><span class=n>file_or_dir_path</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>files</span> <span class=o>=</span> <span class=p>[</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>file_or_dir_path</span><span class=p>,</span> <span class=n>file</span><span class=p>)</span> <span class=k>for</span> <span class=n>file</span> <span class=ow>in</span> <span class=n>os</span><span class=o>.</span><span class=n>listdir</span><span class=p>(</span><span class=n>file_or_dir_path</span><span class=p>)]</span>
</span></span><span class=line><span class=cl><span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>files</span> <span class=o>=</span> <span class=p>[</span><span class=n>file_or_dir_path</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Upload each file</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>file_path</span> <span class=ow>in</span> <span class=n>files</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Fetch: </span><span class=si>{</span><span class=n>file_path</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>file_input</span><span class=o>.</span><span class=n>send_keys</span><span class=p>(</span><span class=n>file_path</span><span class=p>)</span>  <span class=c1># Upload the file(s)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Click the &#39;Get a link&#39; button</span>
</span></span><span class=line><span class=cl><span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Clicking the &#39;Get a link&#39; button...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>get_link_button</span> <span class=o>=</span> <span class=n>WebDriverWait</span><span class=p>(</span><span class=n>driver</span><span class=p>,</span> <span class=mi>30</span><span class=p>)</span><span class=o>.</span><span class=n>until</span><span class=p>(</span><span class=n>EC</span><span class=o>.</span><span class=n>element_to_be_clickable</span><span class=p>((</span><span class=n>By</span><span class=o>.</span><span class=n>XPATH</span><span class=p>,</span> <span class=s2>&#34;//button[contains(text(), &#39;Get a link&#39;)]&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>    <span class=n>get_link_button</span><span class=o>.</span><span class=n>click</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;&#39;Get a link&#39; button clicked.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Error clicking the &#39;Get a link&#39; button: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>driver</span><span class=o>.</span><span class=n>quit</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>sys</span><span class=o>.</span><span class=n>exit</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Waiting for Transferring.. text will shown in page</span>
</span></span><span class=line><span class=cl><span class=n>time</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;&#39;Transferring...&#39;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>WebDriverWait</span><span class=p>(</span><span class=n>driver</span><span class=p>,</span> <span class=mi>7200</span><span class=p>)</span><span class=o>.</span><span class=n>until</span><span class=p>(</span><span class=n>EC</span><span class=o>.</span><span class=n>invisibility_of_element_located</span><span class=p>((</span><span class=n>By</span><span class=o>.</span><span class=n>XPATH</span><span class=p>,</span> <span class=s2>&#34;//div[contains(@class, &#39;transfer__window uploader--progress&#39;)]//h2[text()=&#39;Transferring...&#39;]&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Upload complete.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Error waiting for the upload to complete: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>driver</span><span class=o>.</span><span class=n>quit</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>sys</span><span class=o>.</span><span class=n>exit</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>time</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Get the download link</span>
</span></span><span class=line><span class=cl><span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>link</span> <span class=o>=</span> <span class=n>WebDriverWait</span><span class=p>(</span><span class=n>driver</span><span class=p>,</span> <span class=mi>60</span><span class=p>)</span><span class=o>.</span><span class=n>until</span><span class=p>(</span><span class=n>EC</span><span class=o>.</span><span class=n>presence_of_element_located</span><span class=p>((</span><span class=n>By</span><span class=o>.</span><span class=n>CSS_SELECTOR</span><span class=p>,</span> <span class=s2>&#34;.TransferDetails__link.link input.link__url&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>    <span class=n>link</span> <span class=o>=</span> <span class=n>WebDriverWait</span><span class=p>(</span><span class=n>driver</span><span class=p>,</span> <span class=mi>30</span><span class=p>)</span><span class=o>.</span><span class=n>until</span><span class=p>(</span><span class=n>EC</span><span class=o>.</span><span class=n>visibility_of_element_located</span><span class=p>((</span><span class=n>By</span><span class=o>.</span><span class=n>CSS_SELECTOR</span><span class=p>,</span> <span class=s2>&#34;.TransferDetails__link.link input.link__url&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>    <span class=c1># Retrieve the link</span>
</span></span><span class=line><span class=cl>    <span class=n>download_link</span> <span class=o>=</span> <span class=n>link</span><span class=o>.</span><span class=n>get_attribute</span><span class=p>(</span><span class=s2>&#34;value&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Download link: </span><span class=si>{</span><span class=n>download_link</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Error retrieving the download link:&#34;</span><span class=p>,</span> <span class=n>e</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>driver</span><span class=o>.</span><span class=n>quit</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>sys</span><span class=o>.</span><span class=n>exit</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Close the browser</span>
</span></span><span class=line><span class=cl><span class=n>driver</span><span class=o>.</span><span class=n>quit</span><span class=p>()</span>
</span></span></code></pre></div></div><footer class=post-footer><ul class=post-tags></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://ca4mi.github.io/>ca4mi</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>